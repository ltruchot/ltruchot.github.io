{"version":3,"sources":["src/data.js","script.js"],"names":["data","nom","inventeurs","lieux","technologie","quantite","prix","approuve","img","reservation","console","log","identity","a","prop","k","o","sortBy","b","state","authorizedFilter","priceSort","vaccines","products","totalPrice","document","body","classList","add","app","getElementById","innerHTML","header","querySelector","renderHeader","main","renderMain","filter","sort","map","vaccine","i","toFixed","join","footer","commandeElement","btnCommande","btnCancel","renderFooter","isEmpty","length","disabled","style","visibility","id","qte","reduce","acc","addEventListener","e","target","matches","carte","closest","ipt","idx","split","parseInt","value","Number","isNaN","window","alert","push","v"],"mappings":"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","file":"script.803516c8.js","sourceRoot":"..","sourcesContent":["export const data = [\n  {\n    nom: 'BBIBP-CorV',\n    inventeurs: ['Sinopharm'],\n    lieux: ['Chine'],\n    technologie: 'virus inactivé',\n    quantite: 420,\n    prix: 17,\n    approuve: true,\n    img: 'bbibp-corv.jpg',\n    reservation: false,\n  }, {\n    nom: 'Sputnik V',\n    inventeurs: ['Gamaleya'],\n    lieux: ['Russie', 'Inde'],\n    technologie: 'adenovirus',\n    quantite: 130,\n    prix: 12,\n    approuve: false,\n    img: 'sputnik-v.jpg',\n    reservation: false,\n  }, {\n    nom: 'AZD1222',\n    inventeurs: ['AstraZeneca', 'University of Oxford'],\n    lieux: ['Royaume Unis', 'Brésil', 'Inde'],\n    technologie: 'adenovirus',\n    quantite: 5028,\n    prix: 1.78,\n    approuve: false,\n    img: 'azd1222.jpg',\n    reservation: false,\n  }, {\n    nom: 'Tozinameran',\n    inventeurs: ['BioNTech', 'Pfizer', 'Fosun Pharma'],\n    lieux: ['Allemagne', 'USA'],\n    technologie: 'ARN messager',\n    quantite: 980,\n    prix: 14,\n    approuve: true,\n    img: 'tozinameran.jpg',\n    reservation: false,\n  }, {\n    nom: 'mRNA-1273',\n    inventeurs: ['Moderna', 'NIAID', 'BARDA'],\n    lieux: ['USA'],\n    technologie: 'ARN messager',\n    quantite: 240,\n    prix: 28,\n    approuve: false,\n    img: 'mrna-1273.jpg',\n    reservation: false,\n  }, {\n    nom: 'Ad26.COV2.S',\n    inventeurs: ['Johnson & Johnson', 'BIDMC'],\n    lieux: ['USA', 'Amérique du Sud', 'Ukraine', 'Afrique du Sud'],\n    technologie: 'adenovirus',\n    quantite: 110,\n    prix: 31,\n    approuve: false,\n    img: 'ad26-cov2-s.jpg',\n    reservation: false,\n  }];\n","import './styles.scss';\nimport { data } from './src/data';\n\nconsole.log('Pourquoi tu regardes la console ? La confiance règne...');\n\n// la magie des oneliners et du currying\nconst identity = (a) => a;\nconst prop = (k) => (o) => o[k];\nconst sortBy = (k) => (a, b) => a[k] - b[k];\n\n// état complet de l'app\nconst state = {\n  authorizedFilter: false,\n  priceSort: false,\n  vaccines: data, // tous les vaccins\n  products: [], // commande en cours\n  totalPrice: 0,\n};\n\n// ajout de quelques classes tailwind au body\ndocument.body.classList.add('text-gray-200', 'bg-gray-900', 'max-w-7xl', 'mx-auto', 'px-5', 'pt-8', 'pb-32');\n\n// construction du layout de base\nconst app = document.getElementById('app');\napp.innerHTML = `\n<h1 class=\"title-font text-center mb-8 font-extrabold text-6xl tracking-wider\">\n  Covid Killer\n</h1>\n<header class=\"text-center mb-8\">\n</header>\n<main class=\"flex flex-wrap mx-4 mt-4 justify-center\">\n</main>\n<footer class='w-full text-center border-t border-grey p-4 text-white fixed bottom-0 left-0 bg-gray-800'>\n  <h2 class=\"text-xl font-medium mb-3\">\n    Résumé / \n    <button id=\"btn-commande\" class=\"ml-1 p-2 bold rounded bg-blue-100 text-blue-700\">\n      Commander\n    </button>\n    <button id=\"btn-annuler\" class=\"ml-1 p-2 bold rounded bg-red-100 text-red-700\">\n      Annuler\n    </button>\n  </h2>\n  <ul class=\"text-left m-auto max-w-xl flex flex-wrap\" id=\"commande\"></ul>\n</footer>\n`;\n\n/* header */\nconst header = document.querySelector('header');\nconst renderHeader = ({ authorizedFilter, priceSort }) => {\n  // les boutons changent en fonctions des params, grâce à des conditions ternaires\n  header.innerHTML = `\n    <button id=\"btn-filter\" class=\"p-2 bold rounded bg-green-100 text-green-700\">\n    ${authorizedFilter\n    ? 'Montrer tout'\n    : 'Cacher vaccins non approuvé'}\n    </button>\n    <button id=\"btn-sort\" class=\"p-2 bold rounded bg-yellow-100 text-yellow-700\">\n    ${priceSort\n    ? 'Annuler le tri'\n    : 'Trier par prix croissant'}\n    </button>\n `;\n};\nrenderHeader(state);\n\n/* main */\nconst main = document.querySelector('main');\nconst renderMain = ({ vaccines, authorizedFilter, priceSort }) => {\n  // pour faire les cartes, on filtre, on tri, et enfin on map ! Booooooom, j'adore JS\n  // la méthode \".toFixed(2)\" est un classique de l'affichage de devise:\n  // transforme un nombre en string avec 2 chiffres après la virgule\n  // \".join('')\" assemble les élements d'un tableau en une seule string\n  // filter et sort ont une ternaire qui, selon le cas...\n  // ...applique une fonction qui ne fait rien (identity)  ou qui agit. Habile !\n  main.innerHTML = vaccines\n    .filter(authorizedFilter ? prop('approuve') : identity)\n    .sort(priceSort ? sortBy('prix') : identity)\n    .map((vaccine, i) => `\n  <div class=\"carte p-10 md:w-96 flex flex-col\" id=\"item-${i}\">\n    <div class=\"pattern-dots-md gray-light\">\n      <div class=\"rounded bg-gray-800 p-4 transform translate-x-6 -translate-y-6\">\n        <img src=\"${vaccine.img}\" class=\"block w-full mb-4\" />\n        <div class=\"flex items-center mb-2\">\n          <div class=\"w-10 h-10 mr-4 inline-flex items-center justify-center rounded-full ${vaccine.technologie === 'ARN messager' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'} flex-shrink-0 p-2\">\n              <i class=\"fas ${vaccine.technologie === 'ARN messager' ? 'fa-dna' : 'fa-viruses'}\"></i>\n          </div>\n          ${vaccine.technologie}\n        </div>\n        <div class=\"flex-grow\">\n          <h2 class=\"text-xl font-medium mb-3\">${vaccine.nom}</h2>\n          <div class=\"flex\">\n            <input \n              type=\"number\" \n              class=\"ipt-qte text-gray-800 w-1/2 mr-1 p-2 rounded\"\n              ${vaccine.reservation ? 'disabled' : ''}\n               />\n            <button \n              class=\"btn-reserver w-1/2 ml-1 p-2 bold rounded ${vaccine.reservation ? 'bg-gray-500 text-gray-400' : 'bg-blue-100 text-blue-700'}\"\n              ${vaccine.reservation ? 'disabled' : ''}>Réserver</button>\n          </div>\n          <h3 class=\"bold underline mb-2\">Informations complémentaires</h3>\n          <p class=\"leading-relaxed text-sm\">\n             <strong>Prix unit.:</strong> €${vaccine.prix.toFixed(2)}<br />\n             <strong>Qté disponible:</strong> ${vaccine.quantite}<br />\n             <strong>Marque:</strong> ${vaccine.inventeurs.join(', ')}<br />\n             <strong>Lieux:</strong> ${vaccine.lieux.join(', ')}\n          </p>\n        </div>\n      </div>\n    </div>\n  </div>\n  `).join('');\n};\nrenderMain(state);\n\n/* footer */\nconst footer = document.querySelector('footer');\nconst commandeElement = footer.querySelector('#commande');\nconst btnCommande = footer.querySelector('#btn-commande');\nconst btnCancel = footer.querySelector('#btn-annuler');\nconst renderFooter = ({ products, vaccines }) => {\n  const isEmpty = products.length === 0;\n  btnCommande.disabled = isEmpty;\n  btnCancel.style.visibility = isEmpty ? 'hidden' : 'visible';\n  commandeElement.innerHTML = products.map(([id, qte]) => `\n    <li class=\"bg-gray-600 m-2 rounded p-2\">\n      ${vaccines[id].nom}\n      <strong>x${qte} / €${(vaccines[id].prix * qte).toFixed(2)}</strong>\n    </li>\n  `).join('');\n  // oulà, WTF... reduce ? connais pas.\n  // bon en gros, on cumule les prix des vaccins multiplié par les quantitées choisies\n  state.totalPrice = products.reduce((acc, [id, qte]) => (vaccines[id].prix * qte) + acc, 0);\n  btnCommande.innerHTML = `Commander €${state.totalPrice.toFixed(2)}`;\n};\nrenderFooter(state);\n\n// delegation des évènements\nheader.addEventListener('click', (e) => {\n  if (e.target.matches('#btn-filter')) {\n    state.authorizedFilter = !state.authorizedFilter;\n    renderHeader(state);\n    renderMain(state);\n  } else if (e.target.matches('#btn-sort')) {\n    state.priceSort = !state.priceSort;\n    renderHeader(state);\n    renderMain(state);\n  }\n});\n\nmain.addEventListener('click', (e) => {\n  if (e.target.matches('.btn-reserver')) {\n    const carte = e.target.closest('.carte');\n    const ipt = carte.querySelector('.ipt-qte');\n    // ne garder que la partie chiffrée de l'id\n    const idx = carte.id.split('-')[1];\n    const qte = parseInt(ipt.value, 10);\n    if (Number.isNaN(qte) || qte <= 0) {\n      window.alert(`La quantité de vaccin ${state.vaccines[idx].nom} est erronée ou fantaisiste.`);\n      ipt.value = '';\n      return;\n    }\n    if (qte > state.vaccines[idx].quantite) {\n      window.alert(`Il n'y a pas assez de réserve pour le vaccin ${state.vaccines[idx].nom}.`);\n      ipt.value = '';\n      return;\n    }\n\n    // comme les \"if\" ont un return, pas besoin de \"else\"...\n    // ...ceci n'a lieu que si il n'y a pas d'erreur avant\n    state.products.push([idx, qte]);\n    state.vaccines[idx].reservation = true;\n    renderMain(state);\n    renderFooter(state);\n  }\n});\n\nfooter.addEventListener('click', (e) => {\n  if (e.target.matches('#btn-annuler')) {\n    state.products = [];\n    state.vaccines = state.vaccines.map((v) => ({ ...v, reservation: false }));\n    renderFooter(state);\n    renderMain(state);\n  } else if (e.target.matches('#btn-commande')) {\n    document.body.innerHTML = `\n    <div class=\"text-center\">\n      La commande a bien été enregistrée...<br /> \n      Votre compte a été débité de €${state.totalPrice.toFixed(2)}.<br />\n      Le colis est en route, patience !<br />\n      <button onclick=\"location.reload()\" class=\"mt-2 p-2 bold rounded bg-red-100 text-red-700\">\n        Annuler\n      </button>\n    </div>`;\n  }\n});\n"]}